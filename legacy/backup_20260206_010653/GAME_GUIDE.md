# EmojiGame - Godot 完全重构版

## 项目概述

这是一个从 Pygame 完全重构到 Godot 4.6 的弹幕射击游戏（STG/Bullet Hell）。游戏保留了原版的所有核心玩法和系统，并使用 Godot 的现代化架构重新实现。

## 已实现的功能

### ✅ 核心系统
- **玩家系统**: 完整的移动、射击、判定点、无敌时间
- **子弹系统**: 玩家子弹和敌人弹幕，支持多种弹幕模式
- **敌人系统**: 4种移动模式（直线、之字形、圆形、正弦波）
- **Boss系统**: 6个Boss，每个有多阶段和5种独特弹幕模式
- **补给系统**: 5种补给类型（治疗、火力、炸弹、金钱、分数）
- **关卡系统**: 6个关卡，每关包含30秒道中和Boss战
- **UI系统**: 实时显示分数、连击、血条、能量条、Boss血条
- **音乐系统**: 支持关卡BGM和Boss BGM切换
- **数据持久化**: 保存最高分和金钱到本地文件

### 🎮 游戏机制
- **火力系统**: 5级火力，每级增加子弹数量和散射角度
- **炸弹系统**: 清除所有敌人子弹并对敌人造成50点伤害
- **时间停止**: 消耗50能量停止敌人和子弹5秒
- **连击系统**: 连续击杀敌人增加分数倍率（每10连击+10%）
- **自动吸引**: 补给靠近玩家100像素内自动吸引
- **无敌时间**: 受伤后2秒无敌，带闪烁效果

## 操作说明

### 基础操作
- **方向键 ↑↓←→**: 移动玩家
- **Shift**: 慢速移动（精确躲避弹幕）
- **Space**: 射击
- **X**: 使用炸弹（需要炸弹数量 > 0）
- **Z**: 使用时间停止（需要能量 ≥ 50）
- **ESC**: 退出游戏

### 游戏提示
1. **慢速模式**: 按住Shift进入慢速模式，可以看到判定点，更容易躲避密集弹幕
2. **连击系统**: 连续击杀敌人可以增加分数倍率，不要让连击中断
3. **补给收集**: 靠近补给会自动吸引，不用刻意去碰
4. **时间停止**: 在危险时刻使用时间停止可以清理弹幕并重新定位
5. **炸弹使用**: 炸弹可以清除所有敌人子弹，在被包围时使用

## 项目结构

```
EmojiGame/
├── scenes/                 # 场景文件
│   ├── main.tscn          # 主场景（游戏世界）
│   ├── player.tscn        # 玩家场景
│   ├── player_bullet.tscn # 玩家子弹
│   ├── enemy.tscn         # 敌人场景
│   ├── enemy_bullet.tscn  # 敌人子弹
│   ├── boss.tscn          # Boss场景
│   └── supply.tscn        # 补给场景
│
├── scripts/               # 脚本文件
│   ├── main.gd           # 主脚本（游戏初始化）
│   ├── player.gd         # 玩家逻辑（移动、射击、技能）
│   ├── player_bullet.gd  # 玩家子弹逻辑
│   ├── enemy.gd          # 敌人逻辑（移动模式、射击）
│   ├── enemy_bullet.gd   # 敌人子弹逻辑
│   ├── boss.gd           # Boss逻辑（多阶段、弹幕模式）
│   ├── supply.gd         # 补给逻辑（掉落、吸引）
│   ├── game_manager.gd   # 游戏管理器（关卡、分数、敌人生成）
│   ├── game_ui.gd        # UI系统（显示游戏信息）
│   └── music_manager.gd  # 音乐管理器（BGM切换）
│
├── images/                # 图片资源（从原版复制）
│   ├── water.png         # 玩家精灵
│   ├── waterbullet.png   # 玩家子弹
│   ├── enemy1.png        # 敌人精灵
│   ├── enemybullet.png   # 敌人子弹
│   ├── boss1.png         # Boss精灵
│   └── supply.png        # 补给精灵
│
├── audio/                 # 音频资源（从原版复制）
│   ├── bgm1-6.mp3        # 关卡BGM
│   ├── boss1-6.mp3       # Boss BGM
│   ├── death.mp3         # 死亡音效
│   ├── theworld.wav      # 时间停止音效
│   └── gold.wav          # 拾取音效
│
├── project.godot          # Godot项目配置
└── README.md             # 本文档
```

## 技术实现细节

### 玩家系统 (player.gd)
- 使用 `CharacterBody2D` 实现平滑移动
- 支持普通速度(300)和慢速模式(150)
- 根据火力等级(1-5)动态调整射击模式
- 无敌时间2秒，带闪烁效果(modulate.a切换)
- 时间停止能量自动恢复(10/秒)

### 敌人系统 (enemy.gd)
- 4种移动模式可配置:
  - STRAIGHT_DOWN: 直线下落
  - ZIGZAG: 之字形移动
  - CIRCLE: 圆形轨迹
  - SINE_WAVE: 正弦波移动
- 自动瞄准玩家射击
- 受伤闪红效果(0.1秒)
- 死亡时30%概率掉落补给

### Boss系统 (boss.gd)
- 多阶段战斗（根据血量触发）:
  - 阶段1: 800HP - 圆形弹幕
  - 阶段2: 600HP - 螺旋弹幕
  - 阶段3: 400HP - 瞄准散射
  - 阶段4: 200HP - 随机扩散
  - 阶段5: 0HP - 组合模式
- 动态移动和位置切换
- 每个阶段射击间隔减少0.1秒

### 补给系统 (supply.gd)
- 5种补给类型:
  - HEAL: 恢复1点生命
  - POWER: 增加1级火力
  - BOMB: 增加1个炸弹
  - MONEY: 增加金钱
  - SCORE: 增加分数
- 自动吸引机制（100像素内）
- 吸引速度400像素/秒

### 关卡系统 (game_manager.gd)
- 自动生成敌人（每2秒1个）
- 30秒道中后进入Boss战
- 击败Boss后进入下一关
- 6关全部通关即胜利
- 连击系统：2秒内连续击杀

### UI系统 (game_ui.gd)
- 实时显示:
  - 分数（左上角）
  - 连击数（黄色高亮）
  - 关卡数
  - 血条（5格）
  - 火力等级（1-5）
  - 炸弹数量
  - 时间停止能量条（0-100）
  - Boss血条（Boss战时显示）

## 与原版的差异

### 保留的功能
✅ 所有核心玩法机制
✅ 6个关卡和6个Boss
✅ 火力、炸弹、时间停止系统
✅ 连击和分数系统
✅ 补给系统
✅ 音乐系统
✅ 数据持久化

### Godot特有优化
- 使用节点树结构管理游戏对象
- 使用信号系统进行事件通信
- 使用场景实例化管理对象生命周期
- 使用组(Group)系统快速查找对象
- 使用 CharacterBody2D 实现更流畅的移动

## 开发说明

### 如何添加新Boss
1. 在 `boss.gd` 中添加新的弹幕模式函数
2. 在 `shoot_pattern()` 中添加新的阶段判断
3. 创建新的Boss场景并配置精灵和碰撞形状
4. 在 `game_manager.gd` 的 `boss_scenes` 数组中添加新场景

### 如何添加新敌人类型
1. 创建新的敌人场景
2. 在 `enemy.gd` 中添加新的移动模式
3. 配置敌人的血量、速度、分数等属性
4. 在 `game_manager.gd` 中配置生成逻辑

### 如何调整难度
- 修改 `enemy_spawn_interval`: 敌人生成间隔
- 修改 `shoot_interval`: 射击间隔
- 修改敌人和Boss的血量
- 修改子弹速度和数量

## 已知问题和待完善

### 需要添加的内容
1. **主菜单**: 开始游戏、设置、退出
2. **暂停菜单**: 继续、重新开始、退出
3. **游戏结束界面**: 显示最终分数和最高分
4. **音效系统**: 射击、爆炸、拾取等音效
5. **粒子效果**: 爆炸、子弹轨迹等特效
6. **更多Boss**: 每个Boss需要独特的精灵和弹幕模式

### 可能的扩展
- 难度选择（简单、普通、困难、地狱）
- 多个可选角色
- 成就系统
- 回放功能
- 排行榜
- 更多关卡和Boss

## 运行要求

- Godot Engine 4.6 或更高版本
- 支持 OpenGL 4.1 或更高版本的显卡
- 建议分辨率: 480x700 或更高

## 开发工具

- **引擎**: Godot Engine 4.6
- **语言**: GDScript
- **原版**: Pygame (Python)
- **重构工具**: Claude Code + Godot MCP

## 致谢

本项目是从 Pygame 版本的 EmojiGame 完全重构而来，保留了原版的核心玩法和设计理念。感谢原作者创造了这个有趣的弹幕射击游戏！

## 许可证

与原版保持一致。
